[gd_scene load_steps=7 format=2]

[ext_resource path="res://assets/icons/icon_128_circle_thick.svg" type="Texture" id=1]
[ext_resource path="res://components/dashboard/dashboard_container_placeholder.gd" type="Script" id=2]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;
render_mode blend_add;

const float PI = 3.1415926;
const float TAU = 6.2831853;

uniform sampler2D gradient_texture;
uniform vec4 albedo : hint_color;
uniform float power = 1.0;
uniform vec2 pos = vec2(0.5, 0.5);
uniform float turn_speed = 2.0;
uniform float grad_length = 2.0;


float turning(in float time, in float offset, in vec2 uv, in vec2 center, in float speed, in float gl){
    time *= speed;
    uv -= center;
    float x = length(uv);
    float y = mod(atan(uv.y, uv.x) + time + offset, TAU);
    y /= gl;
    
    return clamp(1.0 - y, 0, 1);
}

void fragment() {
	float turn_value = turning(TIME, 0.0, UV, pos, turn_speed, grad_length*PI) + turning(TIME, PI, UV, pos, turn_speed, grad_length*PI);
	COLOR = textureLod(gradient_texture, vec2(turn_value, 0.0), 0.0) * albedo * power;
	COLOR.a *= clamp(texture(TEXTURE, UV).a, 0.0, 1.0);
}"

[sub_resource type="Gradient" id=4]
interpolation_mode = 2
offsets = PoolRealArray( 0, 0.0310421, 1 )
colors = PoolColorArray( 0.164063, 0.164063, 0.164063, 1, 1, 1, 1, 1, 0.164706, 0.164706, 0.164706, 1 )

[sub_resource type="GradientTexture" id=3]
gradient = SubResource( 4 )

[sub_resource type="ShaderMaterial" id=5]
shader = SubResource( 1 )
shader_param/albedo = Color( 1, 1, 1, 1 )
shader_param/power = 1.0
shader_param/pos = Vector2( 0.5, 0.5 )
shader_param/turn_speed = -6.0
shader_param/grad_length = 1.0
shader_param/gradient_texture = SubResource( 3 )

[node name="DashboardPlaceholder" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
script = ExtResource( 2 )

[node name="VBoxContainer" type="VBoxContainer" parent="."]
margin_left = 960.0
margin_top = 540.0
margin_right = 960.0
margin_bottom = 540.0

[node name="Progressing" type="TextureRect" parent="VBoxContainer"]
modulate = Color( 0.537255, 0.819608, 0.945098, 0.498039 )
material = SubResource( 5 )
margin_right = 142.0
margin_bottom = 64.0
rect_min_size = Vector2( 64, 64 )
size_flags_vertical = 4
texture = ExtResource( 1 )
expand = true
stretch_mode = 6

[node name="Label" type="Label" parent="VBoxContainer"]
margin_top = 68.0
margin_right = 142.0
margin_bottom = 88.0
text = "Loading Dashboard"
